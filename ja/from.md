# from関数

from関数は単純にファイルを取り込むだけではなく、プログラムから扱いやすい形式に変換することが出来ます。  

## 書式

byte[] foo = from(ファイル名, [, "コンバータ名"][, "オプション"]);

- ファイル名
  指定したファイル名がロードされ、コンバータ―に渡されます。
  BMP(Indexed Color)ファイルの場合、画像データとして変換されたイメージがコンバータに渡されます。

- コンバータ名  
  スクリプト名を指定します。以下のコンバータが用意されています。
  - sc1  
  BMPデータをMSXのSCREEN1のパターン(&カラー)データに変換する。
  - sc2  
  BMPデータをMSXのSCREEN2のパターン(&カラー)データに変換する。
  - pack  
  ファイルを普通のバイナリとして読み込み、圧縮します。

- オプション  
  カスタムのコンバータを作成する場合にオプションとして渡すことが出来ます。

## コンバータについて

## sc1
BMPデータをMSXのSCREEN1のパターンジェネレータテーブルとカラーテーブル形式のデータに変換します。  
パターンに対応するカラーテーブルのデータは、パターンデータの後ろに連結されます。  
例として256x256のBMPの場合は  
- 256パターン定義できる
- パターンデータは8バイト * 256 = 2048バイト
- 256パターン定義した場合、使用するカラーテーブルは32バイト
- 2048バイト目から32バイトがカラーテーブルとなる

### オプション
  packコンバーターと同じRLE/PRLEが指定できます。

## sc2
BMPデータをMSXのSCREEN2のパターンジェネレータテーブルとカラーテーブル形式のデータに変換します。  
パターンジェネレータテーブルはsc1と同じですが、カラーテーブルは1パターン、1ライン毎に設定できます。
例として256x256のBMPの場合は  
- 256パターン定義できる
- パターンデータはsc1と同様
- 使用するカラーテーブルは1パターン8バイト使用するので 8 * 256 = 2048バイト
- 2048バイト目から2048バイトがカラーテーブルとなる

### オプション
  packコンバーターと同じRLE/PRLEが指定できます。

## pack
ファイルを普通のバイナリとして読み込み、圧縮します。  
圧縮方法をオプションで指定します。  
RLEの仕組みはWikiなどを参考にしてください。  

### オプション
  - RLE  
    RLE圧縮します。  
    ここでは以下のようにデータを格納しています。
    |アドレス| 意味                                           |
    |-------:|:-----------------------------------------------|
    | +0     | 連続するデータ長、0 ～ 255。                   |
    | +1     | 繰り返されるデータが指定されています。         |
  - PRLE  
    PackBits RLE圧縮します。  
    ここでは以下のようにデータを格納しています。
    |アドレス  | 意味                                                                       |
    |---------:|:---------------------------------------------------------------------------|
    | +0       | データ長、0 ～ 127は連続するデータ、-1 ～ -128は不連続のデータを表します。 |
    | +1 ～ +n | 連続データの場合、繰り返されるデータが指定されています。<br/>不連続データの場合、データ長分のデータが格納されています。 |


## カスタムコンバータ
自作のコンバータを定義することが出来ます。
コマンドパレットから`xsm converter`を実行すると、カスタムコンバータ―のテンプレートを生成されます。
